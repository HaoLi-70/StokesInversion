
#include "MPI_CONTROL.h"

/*--------------------------------------------------------------------------------*/

    /*######################################################################
     
     revision log:
        8 Sept. 2021.
     
     ######################################################################*/

/*--------------------------------------------------------------------------------*/

int Mpi_pid;
int Mpi_num_procs;

/*--------------------------------------------------------------------------------*/

extern int CONTROL(void){

    /*######################################################################
      Purpose:
        controls if any CPU has crashed and stops if needed.
      Record of revisions:
        8 Sept. 2021
      Input parameters:
        .
      Return:
        return the current conts.
     ######################################################################*/
    
    MPI_Barrier(MPI_COMM_WORLD);
    
    int a1 = 0, a2 = 0;
    
    MPI_Allreduce(&a1, &a2, 1, MPI_INT, MPI_LOR, MPI_COMM_WORLD);
    
    if (!a2) return 0;
    
    MPI_Finalize();
    exit(1);

    return -1;
}

extern int ABORTED(void){

    /*######################################################################
      Purpose:
        stop the running.
      Record of revisions:
        8 Sept. 2021
     ######################################################################*/

    MPI_Finalize();
    exit(1);
    return -1;
}

/*--------------------------------------------------------------------------------*/

